%==================================================================================================
\chapter{Formulação numérica para dinâmica não linear dos sólidos} \label{EGDS}
%==================================================================================================

Em se tratando de sólidos de comportamento hiperelástico, dada à natureza da lei constitutiva e à adequação da descrição Lagrangiana, é conveniente o uso de abordagens energéticas de modo a obter o equacionamento em forma fraca, seguido da aplicação da técnica de elementos finitos e de processos para solução numérica do sistema resultante. Para tal, deve-se primeiramente definir o conceito de energia total ($\Pi$) de um sistema, que pode ser entendido como a soma de todas as parcelas de energia relevantes ao problema. Nos casos mais comuns, tem-se uma parcela de energia potencial das forças externas atuantes no corpo ($\mathbb{P}$), uma parcela de energia de deformação elástica ($\mathbb{U}$) e parcela de energia cinética ($\mathbb{K}$). Dessa forma, o funcional de energia total é dado por:

\begin{equation}
    \Pi=\mathbb{P}+\mathbb{U}+\mathbb{K}\text{.}
    \label{FuncionalEnergia}
\end{equation}

Busca-se encontrar a configuração de equilíbrio do sólido, e para tal, a conservação da energia deve ser respeitada. Dessa forma postula-se o primeiro teorema variacional, que aponta que, para se obter o equilíbrio em um sólido sujeito a forças externas conservativas, a primeira variação da energia total deve ser nula para qualquer variação admissível nas incógnitas do problema, ou seja:

\begin{equation}
    \delta^{(1)}\Pi=0\forall\delta\BB{u}|\delta\BB{u}=\BB{0}\text{ em }\Gamma_D\text{,}
\end{equation}

\noindent em que $\Gamma_D$ é a parcela da fronteira onde os deslocamentos são prescritos. Já o segundo teorema trata-se da estabilidade desse equilíbrio, onde para se atingir o equilíbrio estável a segunda variação da energia total deve ser positiva para qualquer variação admissível, ou seja:

\begin{equation}
    \delta^{(2)}\Pi>0\forall\delta\BB{u}|\delta\BB{u}=\BB{0}\text{ em }\Gamma_D\text{.}
\end{equation}

Sendo assim, primeiramente procura-se anular a primeira variação da energia total:

\begin{equation}
    \delta\Pi=\delta\mathbb{P}+\delta\mathbb{U}+\delta\mathbb{K}=0\text{,}
\end{equation}

\noindent o que leva à necessidade de se determinar a primeira variação de $\mathbb{U}$. Para isso, é necessária a consideração de um modelo constitutivo que permita, juntamente com as demais equações da cinemática do modelo estrutural, descrever a evolução da energia de deformação em função das variáveis principais do problema. Um possível modelo constitutivo é o de Saint-Venant-Kirchhoff, dado por:

\begin{equation}
    u_e^{SVK}=\frac{K\mathbb{E}}{2}\text{,}
\end{equation}

\textcolor{red}{essa só vale para o caso uniaxial de tensão e é desnecessária aqui. Escreva na forma    $u_e^{SVK}=\frac{\mathbb{E}:\mathbb{C}:\mathbb{E}}{2}=\frac{\mathbb{S}:\mathbb{E}}{2}$ onde $\mathbb{C}$ é o tensor constitutivo de quarta ordem, a ajuste com o texto abaixo}.

Assim, as parcelas de energia ficam dadas por:

\begin{subequations}
    \begin{align}
         & \mathbb{U}=\frac{1}{2}\intDomi{S_{ij}\mathbb{E}_{ij}}\text{,}    \\
         & \mathbb{P}=-F_i^aY_i^a-\intFronti{t_iy_i^m}\text{ e}             \\
         & \mathbb{K}=\frac{1}{2}\intDomi{\rho_0\dot{y}_i\dot{y}_i}\text{,}
    \end{align}
\end{subequations}

\noindent onde $\Omega_0$ é o domínio de análise em sua configuração inicial, cuja fronteira é $\Gamma_0=\partial\Omega_0$, $F_i^a$ é uma força concentrada aplicada sobre um ponto $a$ na direção $i$, cuja posição atual é $Y_i^a$, $t_i$ é uma força distribuída sobre uma superfície média da casca ($y_i$), $\rho_0$ é a massa específica inicial do contínuo e  $S_{ij}$ é o tensor de Piola-Kirchhoff de segunda espécie, escrito como:

\begin{equation}
    S_{ij}=\script{C}_{ijkl}\mathbb{E}_{kl}\text{,}
    \label{eq:CSD-S}
\end{equation}

\noindent sendo $\script{C}_{ijkl}$ o tensor constitutivo de quarta ordem:

\begin{equation}
    \script{C}_{ijkl}=2G\delta_{ik}\delta_{jl}+\frac{2G\nu}{1-2\nu}\delta_{ij}\delta_{kl}
\end{equation}

\noindent no qual $\nu$ é o coeficiente de Poisson e $G$ é o módulo de elasticidade transversal, dado em função do módulo de elasticidade longitudinal (ou Módulo de Young) $E$ como:

\begin{equation}
    G=\frac{E}{2(1+\nu)}\text{.}
\end{equation}

%\noindent O Apêndice \ref{Ap:CSD} trata de forma mais detalhada o comportamento para casos multiaxiais.

%==================================================================================================
\section{Método dos Elementos Finitos Posicional Aplicado a Elementos de Casca} \label{MEFP}
%==================================================================================================

\textcolor{red}{Deixe a parcela dissipativa de fora...}

\subsection{Cinemática de Reissner-Mindlin}

\textcolor{red}{Aqui você precisa escrever de forma melhor detalhada, deixar um conjunto de 9 equações sem texto não é viável. Tente reorganizar seguindo a lógica do meu texto de livre docência (página 62). Lá está bem compacto. Se você não tiver o texto, é só me pedir...}


Para se realizar o cálculo dessas propriedades, será considerada uma aproximação das variáveis por meio de polinômios aproximadores (funções de forma), na qual será utilizado um espaço intermediário de coordenadas paramétricas ($\BB{\xi}$) no procedimento. A Figura \ref{fig:Mapeamento} apresenta esquematicamente o mapeamento das coordenadas da superfície média em seus respectivos espaços.

\begin{figure}[h!]
    \centering
    \caption{Mudança de configuração.}
    \includegraphics[width=.4\linewidth]{Figuras/Mapeamento.pdf}
    \\Fonte: Autoria Própria (\the\year).
    \label{fig:Mapeamento}
\end{figure}

Sendo assim, os parâmetros dependentes do espaço podem ser aproximados como:

\begin{subequations}
    \begin{align}
         & f_i^{m0}=x_i^m=X_i^aN_a(\xi_1,\xi_2)\text{,}                                            \\
         & f_i^{m1}=y_i^m=Y_i^aN_a(\xi_1,\xi_2)\text{,}                                            \\
         & f_i^0=x_i^m+v_i^0\text{,}                                                               \\
         & f_i^1=y_i^m+v_i^1\text{,}                                                               \\
         & v_i^0=\frac{h_0}{2}N_ a(\xi_1,\xi_2)(V^0)_i^a\xi_3\text{,}                              \\
         & v_i^1=\frac{h_0}{2}N_ a(\xi_1,\xi_2)(V^0)_i^a[\xi_3+\alpha(\xi_1,\xi_2)\xi_3^2]\text{,} \\
         & \alpha(\xi_1,\xi_2)=\Alpha^aN_a(\xi_1,\xi_2)\text{,}                                    \\
         & t_i=T_i^aN_a(\xi_1,\xi_2)\text{ e}                                                      \\
         & q_i=Q_i^aN_a(\xi_1,\xi_2)\text{,}
    \end{align}
\end{subequations}

\noindent em que $X_i^a$ representa a posição inicial de um nó $a$, $f_i^{m0}$ e $f_i^{m1}$ são as funções de mudança de configuração da superfície média $\Omega_\xi\to\Omega_0$ e $\Omega_\xi\to\Omega$, respectivamente, onde $\Omega_\xi$ é o espaço paramétrico e $\Omega$ é a configuração atual do contínuo, $v_i^0$ é o vetor unitário normal à superfície média, $v_i^1$ é o vetor generalizado na configuração atual, $h_0$ é a espessura inicial da casca, $N_a$ é a função de forma, $T_i^a$ é o valor de $t_i$ sobre o nó $a$, $Q_i^a$ é o valor de $q_i$ sobre o nó $a$ e $\alpha$ é uma variável inserida no problema, denominada como taxa de variação da espessura, cujo valor sobre o nó $a$ é $\Alpha^a$ \cite{sanches2013unconstrained,sanches2014fluid}.

Note que $\BB{f}(\BB{x},t)=\BB{f}^1((\BB{f}^0)^{-1},t)$, portanto é possível se obter o gradiente da função de mudança de configuração ($\BB{A}=\partial\BB{f}/\partial\BB{x}$) como $\BB{A}=\BB{A}^1\cdot(\BB{A}^0)^{-1}$, em que $A^0_{ij}=f^0_{i,j}$ e $A^1_{ij}=f^1_{i,j}$.

Assim, considera-se o princípio da conservação da energia como:

\begin{equation}
    \delta\Pi=\der{\Pi_0}{g_i}\delta g_i=0\text{,}
\end{equation}

\noindent em que $\BB{g}$ representa o vetor que contém todos os graus de liberdade do problema.

Logo, precisa-se calcular a derivada de $\Pi_0$ em relação à $\BB{Y}$, $\BB{V}^1$ e $\BB{\Alpha}$. Dessa forma tem-se as seguintes derivadas:

\begin{subequations}
    \begin{equation}
        \begin{split}
            \der{\Pi_0}{Y_i^a}=&\der{\mathbb{U}}{Y_i^a}+
            \intDomi{\lambda_m\rho_0N_a\dot{y}_i}+
            \intDomi{\rho_0N_a\ddot{y}_i}-
            F_i^a-\\
            &\intFronti{N_at_i}
            -\intFronti{N_aq_i}=0\text{,}
        \end{split}
    \end{equation}
    \begin{equation}
        \begin{split}
            \der{\Pi_0}{(V^1)_i^a}=&\der{\mathbb{U}}{(V^1)_i^a}
            +\intDomi{\lambda_m\rho_0\frac{h_0}{2}N_a(\xi_3+\alpha\xi_3^2)\dot{y}_i}\\
            &+\intDomi{\rho_0\frac{h_0}{2}N_a(\xi_3+\alpha\xi_3^2)\ddot{y}_i}-
            \intFronti{q_i\frac{h_0}{2}N_a(\xi_3+\alpha\xi_3^2)}=0\text{,}
        \end{split}
    \end{equation}
    \begin{equation}
        \begin{split}
            \der{\Pi_0}{\Alpha^a}=&\der{\mathbb{U}}{\Alpha^a}
            +\intDomi{\lambda_m\rho_0\frac{h_0}{2}(V^1)_i^bN_aN_b\xi_3^2\dot{y}_i}\\
            &+\intDomi{\rho_0\frac{h_0}{2}N_aN_b(V^1)_i^b\xi_3^2\ddot{y}_i}-
            \intFronti{q_i\frac{h_0}{2}(V^1)_i^bN_aN_b\xi_3^2}=0\text{,}
        \end{split}
    \end{equation}
\end{subequations}

\noindent sendo possível definir um vetor resíduo $\BB{r}$ como:

\begin{equation}
    r_i^a(\BB{Y},\BB{V}^1,\BB{\Alpha})=(F^\mathrm{int})_i^a+(F^\mathrm{amort})_i^a+(F^\mathrm{inerc})_i^a-(F^\mathrm{c})_i^a-(F^\mathrm{nc})_i^a=0\text{,}
    \label{eq:CSD-g}
\end{equation}

\noindent sendo $\BB{Y}$, $\BB{V}^1$ e $\Alpha$ os vetores dos graus de liberdade nodais do elemento analisado:

\begin{subequations}
    \begin{align}
         & (F^\mathrm{int})_i^a=\intDomi{\der{u_e}{g_i^a}}=\intDomi{S_{kl}\der{\mathbb{E}_{kl}}{g_i^a}}\text{,}\label{eq:CSD-Fint} &  & \text{Forças internas}          \\
         & (F^\mathrm{amort})_i^a=\intDomi{\lambda_m\rho_0\der{y_j}{g_i^a}\dot{y}_j}\text{,}\label{eq:CSD-Famort}                  &  & \text{Forças de amortecimento}  \\
         & (F^\mathrm{inerc})_i^a=\intDomi{\rho_0\der{y_j}{g_i^a}\ddot{y}_j}\text{,}\label{eq:CSD-Finerc}                          &  & \text{Forças inerciais}         \\
         & (F^\mathrm{c})_i^a=F_j^b\der{Y_j^b}{g_i^a}+\intFronti{t_j\der{y_j^m}{g_i^a}}\text{ e}\label{eq:CSD-Fc}                  &  & \text{Forças conservativas}     \\
         & (F^\mathrm{nc})_i^a=\intFronti{q_j\der{y_j^m}{g_i^a}}\text{.}\label{eq:CSD-Fnc}                                         &  & \text{Forças não-conservativas}
    \end{align}
    \label{eq:CSD-F}
\end{subequations}

Portanto o problema ser resolvido é descrito como: determinar $\BB{Y}$, $\BB{V}^1$ e $\BB{\Alpha}$ tais que $\BB{r}(\BB{Y},\BB{V}^1,\BB{\Alpha})=\BB{0}$.

Como é possível perceber, o cálculo de $\BB{r}$ é dependente não somente dos graus de liberdade, mas também das derivadas temporais de primeira e segunda ordem das posições. Sendo assim, se faz necessária a consideração de um integrador temporal, o qual será utilizado o integrador temporal de Newmark, devido à capacidade de respeitar a conservação de momento linear para $\gamma=1/2$ e apresentando bons resultados para modelagem de elementos de casca, conforme apresentado por \citeonline{sanches2013unconstrained}.

A aproximação realizada pelo integrador de Newmark é dada por:

\begin{subequations}
    \begin{equation}
        g_i^{n+1}=g_i^n+\dot{g}_i^n\Delta t+\Delta t^2\bigpar{\bigpar{\frac{1}{2}-\beta}\ddot{g}_i^n+\beta\ddot{g}_i^{n+1}}\text{ e}
    \end{equation}
    \begin{equation}
        \dot{g}_i^{n+1}=\dot{g}_i^n+\Delta t(1-\gamma)\ddot{g}_i^n+\gamma\ddot{g}_i^{n+1}\Delta t\text{,}
    \end{equation}
\end{subequations}

\noindent sendo o superíndice $n$ e $n+1$ a indicação do passo de tempo analisado ($t_n$ e $t_{n+1}$), $\Delta t$ o intervalo de tempo discretizado e $\beta$ e $\gamma$ parâmetros livres, que devem ser escolhidos de forma a garantir a convergência do método, sendo arbitrados valores de $\beta=1/4$ e $\gamma=1/2$, garantindo a estabilidade incondicional do método \cite{LINDFIELD2019239}.

Isolando-se os termos incógnitos em função de variáveis não derivadas no tempo em $n+1$ e daquelas já conhecidas tem-se:

\begin{subequations}
    \begin{align}
         & \ddot{g}_i^{n+1}=\frac{g_i^{n+1}}{\beta\Delta t^2}-Q_i^n                                \\
         & \dot{g}_i^{n+1}=\frac{\gamma}{\beta\Delta t}g_i^{n+1}+R_i^n-\gamma\Delta tQ_i^n\text{,}
    \end{align}
    \label{eq:CSD-Newmark2}
\end{subequations}

\noindent em que:

\begin{subequations}
    \begin{align}
         & Q_i^n=\frac{g_i^n}{\beta\Delta t^2}+\frac{\dot{g}_i^n}{\beta\Delta t}+\bigpar{\frac{1}{2\beta}-1}\ddot{g}_i^n \\
         & R_i^n=\dot{g}_i^n+\Delta t(1-\gamma)\ddot{g}_i^n\text{.}
    \end{align}
    \label{eq:CSD-QnRn}
\end{subequations}

Já para procurar valores de $\BB{g}$ que anulem $\BB{r}$, utiliza-se o Método de Newton-Raphson, o qual parte da aproximação por série de Taylor truncada no termo de primeira ordem:

\begin{equation}
    \begin{split}
        &\BB{r}(\BB{g}+\Delta\BB{g})=\BB{r}(\BB{g})+\apderp{\BB{r}}{\BB{g}}{\BB{g}}\Delta\BB{g}=\\
        &\BB{r}(\BB{Y},\BB{V}^1,\BB{\Alpha})+\apderp{\BB{r}}{\BB{Y}}{\BB{Y}}\Delta\BB{Y}+\apderp{\BB{r}}{\BB{V}^1}{\BB{V}^1}\Delta\BB{V}^1+\apderp{\BB{r}}{\BB{\Alpha}}{\BB{\Alpha}}\Delta\BB{\Alpha}=\BB{0}\text{.}
    \end{split}
\end{equation}

\noindent Dessa forma, necessita-se do cálculo de uma matriz Hessiana ($H_{ij}^{ab}$):

\begin{equation}
    H_{ij}^{ab}=\frac{\partial^2\Pi_0}{\partial g_j^b\partial g_i^a}=\der{r_i^a}{g_j^b}\text{.}
\end{equation}

Substituindo-se as derivadas temporais da aproximação de Newmark em $\BB{r}$ e realizando as devidas simplificações, obtém-se:

\begin{equation}
    H_{ij}^{ab}=(H^\text{est})_{ij}^{ab}+\frac{\gamma C_{ij}^{ab}}{\beta\Delta t}+\frac{M_{ij}^{ab}}{\beta\Delta t^2}+\intDom{\rho_0(\lambda_m\dot{y}_k+\ddot{y}_k)\Dder{y_k}{g_j^b}{g_i^a}}\text{,}
    \label{eq:CSD-Hijab}
\end{equation}

\noindent sendo $(H^\text{est})_{ij}^{ab}$ a matriz hessiana estática elementar, $M_{ij}^{ab}$ a matriz de massa e $C_{ij}^{ab}$ a matriz de amortecimento, dadas por:

\begin{subequations}
    \begin{align}
         & (H^\text{est})_{ij}^{ab}=\Dder{\mathbb{U}}{g_j^b}{g_i^a}=\intDomi{\bigpar{\der{S_{kl}}{g_j^b}\der{\mathbb{E}_{kl}}{g_i^a}+S_{kl}\Dder{\mathbb{E}_{kl}}{g_i^a}{g_j^b}}} \\
         & C_{ij}^{ab}=\intDomi{\lambda_m\rho_0\der{y_k}{g_i^a}\der{y_k}{g_j^b}}\text{ e}                                                                                         \\
         & M_{ij}^{ab}=\intDomi{\rho_0\der{y_k}{g_i^a}\der{y_k}{g_j^b}}\text{.}
    \end{align}
    \label{eq:CSD-HMC}
\end{subequations}

\noindent também observa-se que a derivada mista de $y_k$ em relação a $g_i^a$ e $g_j^b$ possuirá valores não-nulos apenas quando for derivada de forma cruzada em relação a $V^1$ e $\Alpha$.

Com isso, encontra-se um vetor de correções dos graus de liberdade ($\Delta\BB{g}$) como a solução do sistema:

\begin{equation}
    H_{ij}\Delta g_j=-r_i\text{,}
\end{equation}

\noindent tendo como critério de parada a medida do erro:

\begin{equation}
    \frac{\norm{\Delta\BB{Y}}}{\norm{\BB{X}}}\leq\text{tol,}
    \label{eq:CSD-erro}
\end{equation}

\noindent em que $\BB{X}$ o vetor de posições nodais iniciais e tol uma tolerância admitida.

%%==================================================================================================
%\subsection{Procedimento Computacional} \label{MEFP-Comp}
%%==================================================================================================
%
%Para a implementação computacional realizou-se uma integração em $\Omega_0$ e $\Gamma_0$ segundo a quadratura de hammer \cite{hammer1956numerical}, sendo a malha gerada %automaticamente via comunicação direta do algoritmo com o \textit{Gmsh} e o procedimento paralelizado utilizando o protocolo MPI presente na biblioteca PETSc. Demais informações %relevantes à implementação computacional são descritas detalhadamente no capítulo \ref{MetodologiaCronograma}.
%
%O algoritmo visto no Apêndice \ref{Ap:Shell-alg} apresentado na forma de pseudocódigo exemplifica o código implementado.

%==================================================================================================
\subsection{Exemplos de Verificação} \label{MEFP-Ex}
%==================================================================================================

Para verificação do código implementado, estudou-se para problemas estáticos: a simulação de \textit{Scordelis-Lo roof} e o problema de cilindro biengastado, enquanto para problemas dinâmicos estudou-se o comportamento de vigas engastadas. Tais simulações executadas, contendo os parâmetros de entrada, assim como a discretização de cada problema e os resultados obtidos, são apresentados nos Apêndices \ref{Ap:SLR}, \ref{Ap:Shell-cyl} e \ref{Ap:DinBeam}, para os respectivos problemas.